<?phpsession_start();include_once '../dbconnect.php';	if (isset($_SESSION['odontoUserSession_ID']))	{	  $query = $DBcon->query("SELECT user_type FROM access WHERE id=".$_SESSION['odontoUserSession_ID']);	  $userRow=$query->fetch_array();	  		if ($userRow['user_type'] != 'root' and $userRow['user_type'] != 'admin')		  header("Location: ../index.php");		  	  $DBcon->close();		}else	  header("Location: ../index.php");?><!doctype html><html>  <head>    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />	<link rel="shortcut icon" href="../img/icon.png" type="image/x-icon">	<link rel="stylesheet" type="text/css" href="../css/main.css?version=1">	<title>Odontologia Especializada</title>   </head>  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" type="text/javascript"></script>  <script src="default/jquery.maskMoney.js" language="javascript"></script>      <script language="javascript">	function AreYouSure(form)	{	  return confirm('Tem certeza de que deseja deletar?');	}		function printDiv(divName)	{		 var printContents = document.getElementById(divName).innerHTML;		 var originalContents = document.body.innerHTML;		 document.body.innerHTML = printContents;		 window.print();		 document.body.innerHTML = originalContents;	}		function moneyMaskIt(input)	{		$(function() {$(input).maskMoney({prefix:'R$ ', allowNegative: true, thousands:'.', decimal:',', affixesStay: false});})	}	</script>   <body>  <div id="wrapper"> <!-- Divisão, corpo da página inteira. -->	<div id="header" class="no-print"> <!-- Cabeçalho. -->   	  <?php $nb = file_get_contents('./default/navbar.html'); echo $nb; ?>	</div> <!-- Fim Cabeçalho. -->        <div id="content"> <!-- Corpo da página. -->			<?php				  if (isset($_POST['cash_in'])) {					$Desc = htmlspecialchars($_POST["procedure"]) . ' - ' . htmlspecialchars($_POST["patient"]);			$Date = htmlspecialchars($_POST["date"]);			$Method = htmlspecialchars($_POST["method"]);			$Valor = htmlspecialchars($_POST["valor"]);									// MySQL Connection  			  $DBcon = new MySQLi($DBhost,$DBuser,$DBpass,$DBname);									if ($DBcon->connect_errno) {				  die("ERROR : -> ".$DBcon->connect_error);				}				  				  $line = $DBcon->query("INSERT INTO `finances` (`id`, `type`,`date`, `description`, `value`, `method`)							VALUES (NULL, 'IN','$Date', '$Desc', '$Valor', '$Method');");				  if ($line)									echo '<span class="server_response">Entrada cadastrada '. date("d/m/Y", strtotime($Date)) .'!</span>';				  else					echo $DBcon->error();		  // Closing the DB connection		  $DBcon->close();		  }		  		  if (isset($_POST['cash_out'])) {		  // User Data			$Desc = htmlspecialchars($_POST["desc"]);		$Date = htmlspecialchars($_POST["date"]);			$Method = htmlspecialchars($_POST["method"]);	$Valor = htmlspecialchars($_POST["valor"]);		  			// MySQL Connection  			  $DBcon = new MySQLi($DBhost,$DBuser,$DBpass,$DBname);									if ($DBcon->connect_errno) {				  die("ERROR : -> ".$DBcon->connect_error);				}				  				  $line = $DBcon->query("INSERT INTO `finances` (`id`, `type`, `date`, `description`, `value`, `method`)							VALUES (NULL, 'OUT', '$Date', '$Desc', '$Valor', '$Method');");								  if ($line)						echo '<span class="server_response">Saída cadastrada '. date("d/m/Y", strtotime($Date)) .'!</span>';				  else					echo $DBcon->error();						  // Closing the DB connection		  $DBcon->close();		  }		  		  if (isset($_POST['edit_entry'])) {			$ID = htmlspecialchars($_POST["id"]);			$Date = htmlspecialchars($_POST["date"]);			$Desc = htmlspecialchars($_POST["desc"]);			$Cash = htmlspecialchars($_POST["cash"]);			$Method = htmlspecialchars($_POST["method"]);		  			// MySQL Connection  			  $DBcon = new MySQLi($DBhost,$DBuser,$DBpass,$DBname);									if ($DBcon->connect_errno) {				  die("ERROR : -> ".$DBcon->connect_error);				}				  				  $line = $DBcon->query("UPDATE `finances` SET `date` = '$Date', `description` = '$Desc', `value` = '$Cash', `method` = '$Method' WHERE `finances`.`id` = $ID");				  if ($line)									echo '<span class="server_response">'. $Desc .' atualizado!</span>';				  else					echo '<span class="server_response">Erro ao atualizar...</span>';				  			// Closing the DB connection			  $DBcon->close();		  }		  		  if (isset($_POST['del_entry'])) {			$ID = htmlspecialchars($_POST["id"]);		  			// MySQL Connection  			  $DBcon = new MySQLi($DBhost,$DBuser,$DBpass,$DBname);									if ($DBcon->connect_errno) {				  die("ERROR : -> ".$DBcon->connect_error);				}				  				  $line = $DBcon->query("DELETE FROM `finances` WHERE `finances`.`id` = $ID");		  			  				if ($line)				  echo '<span class="server_response">Item ['. $ID .'] deletado!</span>';				else				  echo '<span class="server_response">Erro ao deletar...</span>';			  			// Closing the DB connection			  $DBcon->close();		  }		  		?>  		  <form id='cash' method='post' action=''>		<div id="subtitle">		Entrada            <button id='imgbut' type="submit" name="cash_in">			  <img class="icon" src="../img/save.png">			  Cadastrar			</button>		</div>	  	    <div id="container">		<p>            <label for="patient">Paciente</label>            <label for="procedure" style="margin-left: 178px;">Procedimento</label><br>			<input type="text" name="patient" required="required" style="width: 225px; height:25px; display: inline-block;">						<select name='procedure' style='width: 225px; height:25px; display: inline-block;'>			<?php			// MySQL Connection  			  $DBcon = new MySQLi($DBhost,$DBuser,$DBpass,$DBname);									if ($DBcon->connect_errno) {				  die("ERROR : -> ".$DBcon->connect_error);				}												$query = $DBcon->query("SELECT * FROM `types`");												  					while($array = $query->fetch_array())					{													  if($array[1] == $Type)						echo "<option value='$array[1]' selected>$array[1]</option>";					  else					    echo "<option value='$array[1]'>$array[1]</option>";					}					  $query->free();													  // Closing the DB connection			    $DBcon->close();													?>			</select>		</p>		<p>			<label for="date">Data</label>			<label for="method" style="margin-left: 199px;">Método</label><br>			<select name='method' style='float: right;  width: 225px; height:25px; display: inline-block;'>				<option value="Dinheiro">Dinheiro</option>				<option value="Cartão">Cartão</option>			</select>			<input type="date" name="date" required="required" style="width: auto; height:25px;">		</p>				<p>			<label for="valor" style="margin-left: 230px;">Valor R$</label><br>            <input type="text" name="valor" required="required" placeholder="R$ 00,00" onKeyUp="moneyMaskIt(this)" style="float: right; width: 225px; height:25px;">		</p>		</div>	</form>	  <form id='cash' method='post' action=''>		<div id="subtitle">		Saída            <button id='imgbut' type="submit" name="cash_out">			  <img class="icon" src="../img/save.png">			  Cadastrar			</button>		</div>	  	    <div id="container">		<p>            <label for="desc">Descrição</label><br>			<input type="text" name="desc" required="required" style="width: 455px; height:25px; display: inline-block;">		</p>		<p>			<label for="date">Data</label>			<label for="method" style="margin-left: 199px;">Método</label><br>			<select name='method' style='float: right;  width: 225px; height:25px; display: inline-block;'>				<option value="Dinheiro">Dinheiro</option>				<option value="Cartão">Cartão</option>			</select>			<input type="date" name="date" required="required" style="width: auto; height:25px;">		</p>				<p>			<label for="valor" style="margin-left: 230px;">Valor R$</label><br>            <input type="text" name="valor" required="required" placeholder="R$ 00,00" onKeyUp="moneyMaskIt(this)" style="float: right; width: 225px; height:25px;">		</p>		</div>	</form>	  <form method='post' action=''>		<div id="subtitle">		Relatório S/M				<span style="color:#057c5c; font-family:Tahoma; font-size:13px; font-weight:bold; margin-left:350px;">		  De <input type="date" name="date_i" value="<?php $M = date("Y-m-d", strtotime('-1 month')); echo $M;?>" required="required" style="height:25px;">		  à	 <input type="date" name="date_f" value="<?php $Today = date("Y-m-d");echo $Today;?>" required="required" style="height:25px;">		</span>				            <button id='imgbut' type="submit" name="generate">			  <img class="icon" src="../img/gear.png">			  Gerar			</button>		</div>	  </form>	  	    <div id="container">				<?php				  if (isset($_POST['generate'])) {			  			$Di = htmlspecialchars($_POST["date_i"]);		$Df = htmlspecialchars($_POST["date_f"]);		  			// MySQL Connection  			  $DBcon = new MySQLi($DBhost,$DBuser,$DBpass,$DBname);									if ($DBcon->connect_errno) {				  die("ERROR : -> ".$DBcon->connect_error);				}				  				  $line = $DBcon->query("SELECT * FROM `finances` WHERE `date` BETWEEN '$Di' AND '$Df'");										    echo '<div class="line">								<span class="cell" style="width:140px; padding-left: 10px;">DATA</span>								<span class="cell" style="width:425px; padding-left: 10px;">DESCRIÇÃO - CLIENTE</span>								<span class="cell" style="width:100px; padding-left: 5px;">VALOR</span>								<span class="cell" style="width:100px; padding-left: 5px;">MÉTODO</span>							  </div>';										while($array = $line->fetch_array())					{										  if ($array[1] == 'IN')						  					    echo '<form class="line_in" method="post" action="">';											  else					    echo '<form class="line_out" method="post" action="">';		?>								<input type="date" name="date" class="cell" style="color: #414141; width:140px;" value="<?php echo $array[2]; ?>">								<input type="text" name="desc" class="cell" style="color: #414141; width:425px;" value="<?php echo $array[3]; ?>">								<input type="text" name="cash" class="cell" style="color: #414141; width:100px;" value="<?php echo $array[4]; ?>" onKeyUp="moneyMaskIt(this)">																<select name="method" class="cell" style="color: #414141; cursor: pointer; width:100px; height: 25px; text-align: center;">		<?php								if($array[5] == 'Dinheiro')								  echo '<option value="Dinheiro" selected>Dinheiro</option>										<option value="Cartão">Cartão</option>';								else								  echo '<option value="Dinheiro">Dinheiro</option>										<option value="Cartão" selected>Cartão</option>';		?>								  								</select>																  <input type="text" name="id" style="display: none;" value="<?php echo $array[0]; ?>">																  <span class="cell" style="width:118px;">									<button style="background: none; display: inline-block;" type="submit" name="edit_entry">									  <img style="width: 30px;" src="../img/save.png">									</button>									<button style="background: none; display: inline-block;" type="submit" name="del_entry" onclick="return AreYouSure(this);">									  <img style="width: 30px;" src="../img/trash.png">									</button>								  </span>															  </form>		<?php					}									$line->close();						  // Closing the DB connection		  $DBcon->close();		  }		?>	      </div>		<div id="subtitle"></div>	  	      </div>  <!-- Fim Corpo da página. -->    	<div id="footer"><!-- Rodapé. -->	  Developed by Isaque Costa.<br>isaquecostaa@gmail.com	</div><!-- Fim Rodapé. -->	  </div> <!-- Fim Divisão corpo da página. --></body></html>